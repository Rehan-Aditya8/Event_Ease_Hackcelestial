<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EventEase â€“ HackCelestial 2.0</title>
  <link rel="stylesheet" href="../css/style.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""/>
  <!-- Firebase SDK -->
  <script type="module" src="../js/firebase.js"></script>
</head>
<body>
  <header class="app-header">
    <div class="brand">
      <svg width="28" height="28" viewBox="0 0 48 48" aria-hidden="true">
        <defs>
          <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0%" stop-color="#4A90E2"/>
            <stop offset="100%" stop-color="#9B51E0"/>
          </linearGradient>
        </defs>
        <path fill="url(#g)" d="M28 4c6 2 9 7 10 13l-7 7-5-5 2-7-7 2-5-5c6-3 9-4 12-5z"/>
        <circle cx="30" cy="14" r="3" fill="#fff" opacity=".9"/>
        <path d="M13 35c3-6 8-10 14-12l5 5c-2 6-6 11-12 14 1-3-2-6-7-7z" fill="#FF6B6B"/>
      </svg>
      <span>EventEase</span>
    </div>
    <nav class="top-actions">
      <a href="../landing.html" class="btn ghost" title="Home">Home</a>
      <button id="logoutBtn" class="btn ghost" title="Logout">Logout</button>
    </nav>
    
  </header>

  <aside class="sidebar">
    <button data-view="dashboard" class="nav-btn active">ğŸ  Dashboard</button>
    <button data-view="ticket" class="nav-btn"> ğŸ« EasyEntry</button>
    <button data-view="announcements" class="nav-btn">ğŸ“¢ Announcements</button>
    <button data-view="lostfound" class="nav-btn">ğŸ” Lost & Found</button>
    <button data-view="emergency" class="nav-btn">ğŸš¨ Medical</button>
  </aside>
  

  <main id="app">
    <section id="dashboard" class="view">
      <!-- User Dashboard (Original Simple Layout) -->
      <div id="user-dashboard">
        <h2 class="view-title">Welcome, <span id="userName">Attendee</span> ğŸ‘‹</h2>
        <p class="user-email">Email: <span id="userEmail">loading...</span></p>
        <div class="grid cards">
          <button class="card link" data-view="ticket"><div class="icon">ğŸ«</div><div class="label">EasyEntry</div></button>
          <button class="card link" data-view="announcements"><div class="icon">ğŸ“¢</div><div class="label">Announcements</div></button>
          <button class="card link" data-view="lostfound"><div class="icon">ğŸ”</div><div class="label">Lost & Found</div></button>
          <button class="card link" data-view="emergency"><div class="icon">ğŸš¨</div><div class="label">Medical</div></button>
          <button class="card link resource-center" onclick="window.location.href='user-resource-center.html'"><div class="icon">ğŸ›¡ï¸</div><div class="label">Resource Center</div></button>
        </div>
      </div>

      
      
      <!-- Volunteer Dashboard (New Enhanced Layout) -->
      <div id="volunteer-dashboard" class="hidden">
        <h2 class="view-title">Welcome back, <span id="volunteerUserName">User</span>! ğŸ‘‹</h2>
        <p class="view-subtitle">Manage your event experience with our comprehensive tools.</p>
        
        <!-- Status Cards -->
        <div class="status-cards">
          <div class="status-card">
            <div class="status-icon">ğŸ«</div>
            <div class="status-content">
              <div class="status-label">ENTRY STATUS</div>
              <div class="status-value" id="entryStatus">Not Generated</div>
            </div>
          </div>
          <div class="status-card">
            <div class="status-icon">ğŸ“¢</div>
            <div class="status-content">
              <div class="status-label">ANNOUNCEMENTS</div>
              <div class="status-value" id="announcementStatus">No New</div>
            </div>
          </div>
        </div>
        
        <!-- Action Cards -->
        <div class="action-cards">
          <button class="action-card" data-view="ticket">
            <div class="action-icon">ğŸ«</div>
            <div class="action-content">
              <div class="action-label">EasyEntry</div>
              <div class="action-description">Scan QR codes and verify attendee tickets.</div>
            </div>
            <div class="action-arrow">â†’</div>
          </button>
          <button class="action-card" data-view="announcements">
            <div class="action-icon">ğŸ“¢</div>
            <div class="action-content">
              <div class="action-label">Announcements</div>
              <div class="action-description">Stay updated with event news.</div>
            </div>
            <div class="action-arrow">â†’</div>
          </button>
          <button class="action-card" data-view="lostfound">
            <div class="action-icon">ğŸ”</div>
            <div class="action-content">
              <div class="action-label">Lost & Found</div>
              <div class="action-description">Report or find lost items.</div>
            </div>
            <div class="action-arrow">â†’</div>
          </button>
          <button class="action-card medical-emergency" data-view="emergency">
            <div class="action-icon">ğŸš¨</div>
            <div class="action-content">
              <div class="action-label">Medical Emergency</div>
              <div class="action-description">Get immediate medical assistance.</div>
            </div>
            <div class="action-arrow">â†’</div>
          </button>
          <button class="action-card" data-view="volunteer-parking">
            <div class="action-icon">ğŸš—</div>
            <div class="action-content">
              <div class="action-label">Parking Management</div>
              <div class="action-description">Manage event parking and vehicle tracking.</div>
            </div>
            <div class="action-arrow">â†’</div>
          </button>
        </div>
      </div>
    </section>

    <section id="ticket" class="view hidden">
      <div class="crumbs">
        <button type="button" class="btn ghost back" data-view="dashboard">â† Back</button>
      </div>
      <h2 class="view-title">EasyEntry</h2>
      
      <!-- User Section (Event Code Form) -->
      <div id="event-code-form" class="card">
        <h3>Enter Event Code</h3>
        <p class="muted">Please enter the 6-digit event code to generate your entry pass</p>
        <form id="eventCodeForm" class="stack">
          <label class="input">
            <span>Event Code</span>
            <input type="text" id="eventCode" placeholder="Enter 6-digit code" maxlength="6" pattern="[0-9]{6}" required />
          </label>
          <button class="btn primary" type="submit">Generate Entry Pass</button>
        </form>
      </div>
      
      <!-- User QR Ticket Display -->
      <div id="qr-ticket" class="card ticket hidden">
        <div class="ticket-grid">
          <div>
            <h3>HackCelestial 2.0</h3>
            <p class="muted">User: <span id="ticketUser">Attendee</span></p>
            <p class="muted">Event Code: <span id="ticketCode">------</span></p>
            <p class="muted">Gate: <strong>3</strong></p>
          </div>
          <div class="qr">
            <div id="qrcode"></div>
            <p class="tiny muted center">Show at gate for entry</p>
          </div>
        </div>
      </div>
      
      <!-- Volunteer Section -->
      <div id="volunteer-easyentry" class="hidden">
        <div class="volunteer-options">
          <div class="option-card">
            <div class="option-icon">ğŸ“±</div>
            <h3>QR Code Scanner</h3>
            <p>Scan attendee QR codes for quick entry verification</p>
            <button id="start-qr-scanner" class="btn primary">Start QR Scanner</button>
          </div>
          
          <div class="option-card">
            <div class="option-icon">ğŸ«</div>
            <h3>Manual Ticket Entry</h3>
            <p>Enter ticket ID manually for verification</p>
            <button id="open-ticket-input" class="btn secondary">Enter Ticket ID</button>
          </div>
        </div>
        
        <!-- QR Scanner Section -->
        <div id="volunteer-scanner" class="hidden">
          <div class="scanner-header">
            <h3>Scan Attendee QR Code</h3>
            <button id="close-scanner" class="btn ghost">â† Back to Options</button>
          </div>
          <div class="scanner-container">
            <video id="scanner-preview" class="scanner"></video>
            <div class="scanner-overlay"></div>
          </div>
          <div id="scan-result" class="scan-result hidden">
            <div class="result-content"></div>
            <button id="reset-scanner" class="btn primary">Scan Another</button>
          </div>
        </div>
        
        <!-- Manual Ticket Input Section -->
        <div id="ticket-input-section" class="hidden">
          <div class="ticket-input-header">
            <h3>Manual Ticket Verification</h3>
            <button id="close-ticket-input" class="btn ghost">â† Back to Options</button>
          </div>
          <div class="card">
            <form id="ticketInputForm" class="stack">
              <label class="input">
                <span>Ticket ID</span>
                <input type="text" id="ticketIdInput" placeholder="Enter ticket ID" required />
              </label>
              <button class="btn primary" type="submit">Verify Ticket</button>
            </form>
            <div id="ticket-result" class="ticket-result hidden">
              <div class="result-content"></div>
              <button id="verify-another" class="btn primary">Verify Another</button>
            </div>
          </div>
        </div>
      </div>
    </section>


    <section id="announcements" class="view hidden">
      <div class="crumbs">
        <button type="button" class="btn ghost back" data-view="dashboard">â† Back</button>
      </div>
      <h2 class="view-title">Announcements</h2>
      
      <div id="volunteer-announcement" class="announcement-form hidden">
        <h3>Make Announcement</h3>
        <form id="announcementForm">
          <div class="form-group">
            <label for="announcementTitle">Title</label>
            <input type="text" id="announcementTitle" placeholder="Announcement title" required>
          </div>
          <div class="form-group">
            <label for="announcementContent">Content</label>
            <textarea id="announcementContent" placeholder="Announcement content" rows="4" required></textarea>
          </div>
          <div class="form-group">
            <label for="announcementPriority">Priority</label>
            <select id="announcementPriority">
              <option value="normal">Normal</option>
              <option value="important">Important</option>
              <option value="urgent">Urgent</option>
            </select>
          </div>
          <button type="submit" class="btn primary">Post Announcement</button>
        </form>
      </div>
      
      <div id="announcements-list" class="announcements-container">
        <div class="announcement-filters">
          <button class="btn ghost active" data-filter="all">All</button>
          <button class="btn ghost" data-filter="normal">Normal</button>
          <button class="btn ghost" data-filter="important">Important</button>
          <button class="btn ghost" data-filter="urgent">Urgent</button>
        </div>
        <ul id="announcement-items" class="list">
          <li class="empty-state">No announcements yet</li>
        </ul>
      </div>
    </section>

    <section id="lostfound" class="view hidden">
  <div class="crumbs">
    <button type="button" class="btn ghost back" data-view="dashboard">â† Back</button>
  </div>
  <h2 class="view-title">Lost & Found</h2>

  <!-- Volunteer Lost & Found Management -->
  <div id="volunteer-lostfound" class="volunteer-lostfound hidden">
    <div class="lostfound-tabs">
      <button class="tab-btn active" data-tab="chat">Chat View</button>
      <button class="tab-btn" data-tab="manage">Manage Items</button>
      <button class="tab-btn" data-tab="reports">Reports</button>
    </div>

    <!-- Chat Tab -->
    <div id="chat-tab" class="tab-content active">
      <div class="volunteer-chat-header">
        <h3>Lost & Found Chat - Volunteer View</h3>
        <div class="chat-stats">
          <span class="stat">Active Chats: <span id="activeChatCount">0</span></span>
          <span class="stat">Resolved Today: <span id="resolvedCount">0</span></span>
        </div>
      </div>
      <div id="volunteerChatBox" class="chat-box volunteer-chat"></div>
      <form id="volunteerChatForm" class="chat-form volunteer-form">
        <input type="text" id="volunteerChatName" placeholder="Your name (Volunteer)" required />
        <input type="text" id="volunteerChatMessage" placeholder="Type a response..." required />
        <input type="file" id="volunteerChatImage" accept="image/*" />
        <button type="submit" class="btn primary">Send Response</button>
      </form>
    </div>

    <!-- Manage Items Tab -->
    <div id="manage-tab" class="tab-content">
      <div class="manage-header">
        <h3>Lost & Found Item Management</h3>
        <button id="addItemBtn" class="btn primary">+ Add Found Item</button>
      </div>
      
      <div class="items-filters">
        <button class="filter-btn active" data-filter="all">All Items</button>
        <button class="filter-btn" data-filter="lost">Lost</button>
        <button class="filter-btn" data-filter="found">Found</button>
        <button class="filter-btn" data-filter="returned">Returned</button>
      </div>

      <div id="itemsList" class="items-list">
        <!-- Items will be populated here -->
      </div>

      <!-- Add Item Modal -->
      <div id="addItemModal" class="modal hidden">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Add Found Item</h3>
            <button id="closeModal" class="close-btn">&times;</button>
          </div>
          <form id="addItemForm" class="modal-form">
            <div class="form-group">
              <label for="itemName">Item Name</label>
              <input type="text" id="itemName" placeholder="e.g., Blue Backpack" required>
            </div>
            <div class="form-group">
              <label for="itemDescription">Description</label>
              <textarea id="itemDescription" placeholder="Detailed description..." rows="3" required></textarea>
            </div>
            <div class="form-group">
              <label for="itemLocation">Found Location</label>
              <input type="text" id="itemLocation" placeholder="e.g., Main Hall, Room 301" required>
            </div>
            <div class="form-group">
              <label for="itemCategory">Category</label>
              <select id="itemCategory" required>
                <option value="">Select category</option>
                <option value="electronics">Electronics</option>
                <option value="clothing">Clothing</option>
                <option value="accessories">Accessories</option>
                <option value="documents">Documents</option>
                <option value="other">Other</option>
              </select>
            </div>
            <div class="form-group">
              <label for="itemImage">Item Photo (Optional)</label>
              <input type="file" id="itemImage" accept="image/*">
            </div>
            <div class="modal-actions">
              <button type="button" id="cancelAdd" class="btn ghost">Cancel</button>
              <button type="submit" class="btn primary">Add Item</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Reports Tab -->
    <div id="reports-tab" class="tab-content">
      <div class="reports-header">
        <h3>Lost & Found Reports</h3>
        <div class="date-filter">
          <label for="reportDate">Filter by Date:</label>
          <input type="date" id="reportDate" />
          <button id="generateReport" class="btn secondary">Generate Report</button>
        </div>
      </div>
      
      <div class="reports-summary">
        <div class="summary-card">
          <div class="summary-number" id="totalItems">0</div>
          <div class="summary-label">Total Items</div>
        </div>
        <div class="summary-card">
          <div class="summary-number" id="returnedItems">0</div>
          <div class="summary-label">Returned</div>
        </div>
        <div class="summary-card">
          <div class="summary-number" id="pendingItems">0</div>
          <div class="summary-label">Pending</div>
        </div>
      </div>

      <div id="reportsList" class="reports-list">
        <!-- Reports will be populated here -->
      </div>
    </div>
  </div>

  <!-- User Lost & Found Chat (Original) -->
  <div id="user-lostfound" class="user-lostfound">
    <div id="chatBox" class="chat-box"></div>
    <form id="chatForm" class="chat-form">
      <input type="text" id="chatName" placeholder="Your name" required />
      <input type="text" id="chatMessage" placeholder="Type a message..." required />
      <input type="file" id="chatImage" accept="image/*" />
      <button type="submit" class="btn primary">Send</button>
    </form>
  </div>
</section>


    <section id="emergency" class="view hidden">
      <div class="crumbs">
        <button type="button" class="btn ghost back" data-view="dashboard">â† Back</button>
      </div>
      <h2 class="view-title">Medical</h2>
      
      <div id="user-medical" class="medical-container">
        <p>If you need immediate medical assistance, press the SOS button below:</p>
        <button id="sos-button" class="sos-button">HELP!</button>
        <div id="location-status" class="status-message hidden">Sending your location...</div>
        <div class="map-preview">
          <h4>Your Location in Navi Mumbai</h4>
          <div id="user-map" class="small-map"></div>
        </div>
      </div>
      
      <div id="volunteer-medical" class="medical-container hidden">
        <h3>Medical Emergency Dashboard - Navi Mumbai</h3>
        
        <!-- Emergency Statistics -->
        <div class="emergency-stats">
          <div class="stat-card">
            <div class="stat-number" id="activeEmergencies">0</div>
            <div class="stat-label">Active Emergencies</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="resolvedToday">0</div>
            <div class="stat-label">Resolved Today</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="avgResponseTime">0</div>
            <div class="stat-label">Avg Response (min)</div>
          </div>
        </div>

        <!-- Emergency Map -->
        <div id="emergency-map" class="map-container large-map">
        </div>
        
        <!-- Emergency Controls -->
        <div class="emergency-controls">
          <div id="emergency-list" class="emergency-list">
            <h4>ğŸš¨ Active Emergency Requests</h4>
            <ul id="emergency-requests" class="requests-list">
            </ul>
          </div>
          
          <div class="emergency-actions">
            <button id="refresh-emergencies" class="btn primary">ğŸ”„ Refresh</button>
            <button id="center-map" class="btn secondary">ğŸ“ Center Map</button>
            <button id="emergency-history" class="btn ghost">ğŸ“‹ History</button>
          </div>
        </div>

        <!-- Emergency Details Modal -->
        <div id="emergencyModal" class="modal hidden">
          <div class="modal-content">
            <div class="modal-header">
              <h3>Emergency Details</h3>
              <button id="closeEmergencyModal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
              <div id="emergencyDetails">
                <!-- Emergency details will be populated here -->
              </div>
            </div>
            <div class="modal-footer">
              <button id="respondToEmergency" class="btn primary">Respond</button>
              <button id="markResolved" class="btn success">Mark Resolved</button>
              <button id="cancelEmergency" class="btn ghost">Cancel</button>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <nav class="bottom-nav">
    <button data-view="dashboard" class="tab active">ğŸ </button>
    <button data-view="schedule" class="tab">ğŸ“…</button>
    <button data-view="announcements" class="tab">ğŸ“¢</button>
    <button data-view="emergency" class="tab">ğŸš¨</button>
  </nav>

  <div id="toast" class="toast hidden"></div>
  
  <script src="../assets/qrcode.min.js"></script>
  <script src="../js/maps.js"></script>
  <script type="module" src="../js/dashboard.js"></script>
</body>
</html>