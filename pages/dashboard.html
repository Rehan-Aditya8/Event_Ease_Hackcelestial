<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EventEase â€“ HackCelestial 2.0</title>
  <link rel="stylesheet" href="../css/style.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""/>
</head>
<body>
  <header class="app-header">
    <div class="brand">
      <svg width="28" height="28" viewBox="0 0 48 48" aria-hidden="true">
        <defs>
          <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0%" stop-color="#4A90E2"/>
            <stop offset="100%" stop-color="#9B51E0"/>
          </linearGradient>
        </defs>
        <path fill="url(#g)" d="M28 4c6 2 9 7 10 13l-7 7-5-5 2-7-7 2-5-5c6-3 9-4 12-5z"/>
        <circle cx="30" cy="14" r="3" fill="#fff" opacity=".9"/>
        <path d="M13 35c3-6 8-10 14-12l5 5c-2 6-6 11-12 14 1-3-2-6-7-7z" fill="#FF6B6B"/>
      </svg>
      <span>EventEase</span>
    </div>
    <nav class="top-actions">
      <a href="../landing.html" class="btn ghost" title="Home">Home</a>
      <button id="logoutBtn" class="btn ghost" title="Logout">Logout</button>
    </nav>
    
  </header>

  <aside class="sidebar">
    <button data-view="dashboard" class="nav-btn active">ğŸ  Dashboard</button>
    <button data-view="ticket" class="nav-btn"> ğŸ« EasyEntry</button>
    <button data-view="announcements" class="nav-btn">ğŸ“¢ Announcements</button>
    <button data-view="lostfound" class="nav-btn">ğŸ” Lost & Found</button>
    <button data-view="emergency" class="nav-btn">ğŸš¨ Medical</button>
  </aside>
  

  <main id="app">
    <section id="dashboard" class="view">
      <!-- User Dashboard (Original Simple Layout) -->
      <div id="user-dashboard">
        <h2 class="view-title">Welcome, <span id="userName">Attendee</span> ğŸ‘‹</h2>
        <div class="grid cards">
          <button class="card link" data-view="ticket"><div class="icon">ğŸ«</div><div class="label">EasyEntry</div></button>
          <button class="card link" data-view="announcements"><div class="icon">ğŸ“¢</div><div class="label">Announcements</div></button>
          <button class="card link" data-view="lostfound"><div class="icon">ğŸ”</div><div class="label">Lost & Found</div></button>
          <button class="card link" data-view="emergency"><div class="icon">ğŸš¨</div><div class="label">Medical</div></button>
        </div>
        
        <!-- Volunteer Parking Management Section (Initially Hidden) -->
        <div id="volunteer-parking-section" class="parking-management-section hidden">
          <div class="view-header">
            <button class="back-btn" onclick="toggleParkingSection()">â† Back to Dashboard</button>
            <h2>Parking Management - Volunteer Dashboard</h2>
            <p>Manage parking slots and bookings for event attendees</p>
          </div>
          
          <!-- Parking Overview Stats -->
          <div class="parking-overview">
            <div class="stat-card">
              <div class="stat-icon">ğŸš—</div>
              <div class="stat-content">
                <div class="stat-number" id="totalSlots">150</div>
                <div class="stat-label">Total Slots</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">âœ…</div>
              <div class="stat-content">
                <div class="stat-number" id="occupiedSlots">87</div>
                <div class="stat-label">Occupied</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">ğŸŸ¢</div>
              <div class="stat-content">
                <div class="stat-number" id="availableSlots">63</div>
                <div class="stat-label">Available</div>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">ğŸ’°</div>
              <div class="stat-content">
                <div class="stat-number" id="todayRevenue">â‚¹12,450</div>
                <div class="stat-label">Today's Revenue</div>
              </div>
            </div>
          </div>
          
          <!-- Active Bookings Management -->
          <div class="active-bookings">
            <div class="section-header">
              <h3>Active Bookings</h3>
              <div class="filter-tabs">
                <button class="filter-tab active" data-filter="all">All</button>
                <button class="filter-tab" data-filter="checked-in">Checked In</button>
                <button class="filter-tab" data-filter="pending">Pending</button>
                <button class="filter-tab" data-filter="expired">Expired</button>
              </div>
            </div>
            
            <div class="bookings-list" id="activeBookingsList">
              <!-- Booking items will be populated by JavaScript -->
              <div class="booking-item">
                <div class="booking-info">
                  <div class="booking-id">#PK001</div>
                  <div class="vehicle-info">
                    <span class="vehicle-type">ğŸš— Car</span>
                    <span class="vehicle-number">MH 12 AB 1234</span>
                  </div>
                  <div class="booking-details">
                    <span class="slot">Slot A-15</span>
                    <span class="duration">2 hours</span>
                    <span class="amount">â‚¹100</span>
                  </div>
                </div>
                <div class="booking-actions">
                  <button class="btn-check-in">Check In</button>
                  <button class="btn-extend">Extend</button>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Real-Time Parking Slot Monitor -->
          <div class="parking-monitor">
            <div class="section-header">
              <h3>ğŸ”´ Live Parking Monitor</h3>
              <div class="monitor-controls">
                <button class="refresh-btn" onclick="refreshParkingData()">ğŸ”„ Refresh</button>
                <div class="auto-refresh">
                  <input type="checkbox" id="autoRefresh" checked>
                  <label for="autoRefresh">Auto-refresh (30s)</label>
                </div>
              </div>
            </div>
            
            <div class="parking-grid">
              <div class="parking-section">
                <h4>Section A - Two Wheelers</h4>
                <div class="slot-grid two-wheeler">
                  <div class="slot available" data-slot="A1">A1</div>
                  <div class="slot occupied" data-slot="A2">A2</div>
                  <div class="slot available" data-slot="A3">A3</div>
                  <div class="slot reserved" data-slot="A4">A4</div>
                  <div class="slot maintenance" data-slot="A5">A5</div>
                  <div class="slot available" data-slot="A6">A6</div>
                  <div class="slot occupied" data-slot="A7">A7</div>
                  <div class="slot available" data-slot="A8">A8</div>
                </div>
              </div>
              
              <div class="parking-section">
                <h4>Section B - Four Wheelers</h4>
                <div class="slot-grid four-wheeler">
                  <div class="slot occupied" data-slot="B1">B1</div>
                  <div class="slot available" data-slot="B2">B2</div>
                  <div class="slot occupied" data-slot="B3">B3</div>
                  <div class="slot available" data-slot="B4">B4</div>
                  <div class="slot reserved" data-slot="B5">B5</div>
                  <div class="slot available" data-slot="B6">B6</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Attendee Assistance Panel -->
          <div class="attendee-assistance">
            <div class="section-header">
              <h3>ğŸ‘¥ Attendee Assistance</h3>
            </div>
            
            <div class="assistance-tools">
              <div class="tool-card">
                <div class="tool-icon">ğŸ”</div>
                <div class="tool-content">
                  <h4>Find Parking</h4>
                  <p>Help attendees find available parking slots</p>
                  <button class="tool-btn" onclick="showParkingFinder()">Open Finder</button>
                </div>
              </div>
              
              <div class="tool-card">
                <div class="tool-icon">ğŸš—</div>
                <div class="tool-content">
                  <h4>Vehicle Lookup</h4>
                  <p>Search for parked vehicles by number plate</p>
                  <div class="lookup-form">
                    <input type="text" placeholder="Enter vehicle number" id="vehicleSearch">
                    <button onclick="searchVehicle()">Search</button>
                  </div>
                </div>
              </div>
              
              <div class="tool-card">
                <div class="tool-icon">âš ï¸</div>
                <div class="tool-content">
                  <h4>Report Issue</h4>
                  <p>Report parking violations or issues</p>
                  <button class="tool-btn alert" onclick="reportIssue()">Report Issue</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Manual Override Controls -->
          <div class="manual-controls">
            <div class="section-header">
              <h3>âš¡ Manual Override</h3>
              <p class="warning">Use these controls only in emergency situations</p>
            </div>
            
            <div class="override-actions">
              <button class="override-btn emergency" onclick="emergencySlotRelease()">
                <span class="btn-icon">ğŸš¨</span>
                Emergency Slot Release
              </button>
              <button class="override-btn" onclick="forceCheckOut()">
                <span class="btn-icon">ğŸ”“</span>
                Force Check-out
              </button>
              <button class="override-btn" onclick="blockSlot()">
                <span class="btn-icon">ğŸš«</span>
                Block Slot
              </button>
              <button class="override-btn" onclick="overridePayment()">
                <span class="btn-icon">ğŸ’³</span>
                Override Payment
              </button>
            </div>
          </div>

          <!-- Communication Center -->
          <div class="communication-center">
            <div class="section-header">
              <h3>ğŸ“ Communication Center</h3>
            </div>
            
            <div class="comm-tools">
              <div class="comm-card">
                <div class="comm-icon">ğŸ“±</div>
                <div class="comm-content">
                  <h4>Contact Attendee</h4>
                  <div class="contact-form">
                    <input type="text" placeholder="Vehicle number or booking ID" id="contactSearch">
                    <button onclick="contactAttendee()">Contact</button>
                  </div>
                </div>
              </div>
              
              <div class="comm-card">
                <div class="comm-icon">ğŸ›¡ï¸</div>
                <div class="comm-content">
                  <h4>Security Alert</h4>
                  <button class="security-btn" onclick="alertSecurity()">Alert Security</button>
                </div>
              </div>
              
              <div class="comm-card">
                <div class="comm-icon">ğŸ“¢</div>
                <div class="comm-content">
                  <h4>Broadcast Message</h4>
                  <textarea placeholder="Type announcement..." id="broadcastMsg"></textarea>
                  <button onclick="broadcastMessage()">Send to All</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Volunteer Shift Analytics -->
          <div class="shift-analytics">
            <div class="section-header">
              <h3>ğŸ“Š Shift Analytics</h3>
            </div>
            
            <div class="analytics-grid">
              <div class="analytics-card">
                <div class="metric-icon">ğŸ‘¥</div>
                <div class="metric-content">
                  <div class="metric-number">47</div>
                  <div class="metric-label">Vehicles Assisted</div>
                </div>
              </div>
              
              <div class="analytics-card">
                <div class="metric-icon">â±ï¸</div>
                <div class="metric-content">
                  <div class="metric-number">3.2 min</div>
                  <div class="metric-label">Avg Response Time</div>
                </div>
              </div>
              
              <div class="analytics-card">
                <div class="metric-icon">âœ…</div>
                <div class="metric-content">
                  <div class="metric-number">12</div>
                  <div class="metric-label">Issues Resolved</div>
                </div>
              </div>
              
              <div class="analytics-card">
                <div class="metric-icon">â­</div>
                <div class="metric-content">
                  <div class="metric-number">4.8/5</div>
                  <div class="metric-label">Satisfaction Rating</div>
                </div>
              </div>
            </div>
            
            <div class="shift-actions">
              <button class="shift-btn" onclick="exportShiftReport()">
                <span class="btn-icon">ğŸ“„</span>
                Export Shift Report
              </button>
              <button class="shift-btn" onclick="logIncident()">
                <span class="btn-icon">ğŸ“</span>
                Log Incident
              </button>
            </div>
          </div>

          <!-- Quick Actions -->
          <div class="quick-actions">
            <button class="action-btn" onclick="showBookingForm()">
              <span class="btn-icon">â•</span>
              New Booking
            </button>
            <button class="action-btn" onclick="showCheckInForm()">
              <span class="btn-icon">ğŸ“</span>
              Manual Check-in
            </button>
            <button class="action-btn" onclick="showSlotManagement()">
              <span class="btn-icon">ğŸ—ï¸</span>
              Manage Slots
            </button>
            <button class="action-btn" onclick="generateReport()">
              <span class="btn-icon">ğŸ“Š</span>
              Generate Report
            </button>
          </div>
        </div>
      </div>

      
      
      <!-- Volunteer Dashboard (Same UI as User Dashboard) -->
      <div id="volunteer-dashboard" class="hidden">
        <h2 class="view-title">Welcome, <span id="volunteerUserName">Volunteer</span> ğŸ‘‹</h2>
        <div class="grid cards">
          <button class="card link" data-view="ticket"><div class="icon">ğŸ«</div><div class="label">EasyEntry</div></button>
          <button class="card link" data-view="announcements"><div class="icon">ğŸ“¢</div><div class="label">Announcements</div></button>
          <button class="card link" data-view="lostfound"><div class="icon">ğŸ”</div><div class="label">Lost & Found</div></button>
          <button class="card link" id="volunteer-parking-card" onclick="toggleParkingSection()"><div class="icon">ğŸš—</div><div class="label">Volunteer Parking</div></button>
          <button class="card link" data-view="emergency"><div class="icon">ğŸš¨</div><div class="label">Medical</div></button>
        </div>
      </div>
    </section>

    <section id="ticket" class="view hidden">
      <div class="crumbs">
        <button type="button" class="btn ghost back" data-view="dashboard">â† Back</button>
      </div>
      <h2 class="view-title">EasyEntry</h2>
      
      <!-- User Section (Event Code Form) -->
      <div id="event-code-form" class="card">
        <h3>Enter Event Code</h3>
        <p class="muted">Please enter the 6-digit event code to generate your entry pass</p>
        <form id="eventCodeForm" class="stack">
          <label class="input">
            <span>Event Code</span>
            <input type="text" id="eventCode" placeholder="Enter 6-digit code" maxlength="6" pattern="[0-9]{6}" required />
          </label>
          <button class="btn primary" type="submit">Generate Entry Pass</button>
        </form>
      </div>
      
      <!-- User QR Ticket Display -->
      <div id="qr-ticket" class="card ticket hidden">
        <div class="ticket-grid">
          <div>
            <h3>HackCelestial 2.0</h3>
            <p class="muted">User: <span id="ticketUser">Attendee</span></p>
            <p class="muted">Event Code: <span id="ticketCode">------</span></p>
            <p class="muted">Gate: <strong>3</strong></p>
          </div>
          <div class="qr">
            <div id="qrcode"></div>
            <p class="tiny muted center">Show at gate for entry</p>
          </div>
        </div>
      </div>
      
      <!-- Volunteer Section -->
      <div id="volunteer-easyentry" class="hidden">
        <div class="volunteer-options">
          <div class="option-card">
            <div class="option-icon">ğŸ“±</div>
            <h3>QR Code Scanner</h3>
            <p>Scan attendee QR codes for quick entry verification</p>
            <button id="start-qr-scanner" class="btn primary">Start QR Scanner</button>
          </div>
          
          <div class="option-card">
            <div class="option-icon">ğŸ«</div>
            <h3>Manual Ticket Entry</h3>
            <p>Enter ticket ID manually for verification</p>
            <button id="open-ticket-input" class="btn secondary">Enter Ticket ID</button>
          </div>
        </div>
        
        <!-- QR Scanner Section -->
        <div id="volunteer-scanner" class="hidden">
          <div class="scanner-header">
            <h3>Scan Attendee QR Code</h3>
            <button id="close-scanner" class="btn ghost">â† Back to Options</button>
          </div>
          <div class="scanner-container">
            <video id="scanner-preview" class="scanner"></video>
            <div class="scanner-overlay"></div>
          </div>
          <div id="scan-result" class="scan-result hidden">
            <div class="result-content"></div>
            <button id="reset-scanner" class="btn primary">Scan Another</button>
          </div>
        </div>
        
        <!-- Manual Ticket Input Section -->
        <div id="ticket-input-section" class="hidden">
          <div class="ticket-input-header">
            <h3>Manual Ticket Verification</h3>
            <button id="close-ticket-input" class="btn ghost">â† Back to Options</button>
          </div>
          <div class="card">
            <form id="ticketInputForm" class="stack">
              <label class="input">
                <span>Ticket ID</span>
                <input type="text" id="ticketIdInput" placeholder="Enter ticket ID" required />
              </label>
              <button class="btn primary" type="submit">Verify Ticket</button>
            </form>
            <div id="ticket-result" class="ticket-result hidden">
              <div class="result-content"></div>
              <button id="verify-another" class="btn primary">Verify Another</button>
            </div>
          </div>
        </div>
      </div>
    </section>


    <section id="announcements" class="view hidden">
      <div class="crumbs">
        <button type="button" class="btn ghost back" data-view="dashboard">â† Back</button>
      </div>
      <h2 class="view-title">Announcements</h2>
      
      <div id="volunteer-announcement" class="announcement-form hidden">
        <h3>Make Announcement</h3>
        <form id="announcementForm">
          <div class="form-group">
            <label for="announcementTitle">Title</label>
            <input type="text" id="announcementTitle" placeholder="Announcement title" required>
          </div>
          <div class="form-group">
            <label for="announcementContent">Content</label>
            <textarea id="announcementContent" placeholder="Announcement content" rows="4" required></textarea>
          </div>
          <div class="form-group">
            <label for="announcementPriority">Priority</label>
            <select id="announcementPriority">
              <option value="normal">Normal</option>
              <option value="important">Important</option>
              <option value="urgent">Urgent</option>
            </select>
          </div>
          <button type="submit" class="btn primary">Post Announcement</button>
        </form>
      </div>
      
      <div id="announcements-list" class="announcements-container">
        <div class="announcement-filters">
          <button class="btn ghost active" data-filter="all">All</button>
          <button class="btn ghost" data-filter="normal">Normal</button>
          <button class="btn ghost" data-filter="important">Important</button>
          <button class="btn ghost" data-filter="urgent">Urgent</button>
        </div>
        <ul id="announcement-items" class="list">
          <li class="empty-state">No announcements yet</li>
        </ul>
      </div>
    </section>

    <section id="lostfound" class="view hidden">
  <div class="crumbs">
    <button type="button" class="btn ghost back" data-view="dashboard">â† Back</button>
  </div>
  <h2 class="view-title">Lost & Found Chat</h2>

  <div id="chatBox" class="chat-box"></div>

  <form id="chatForm" class="chat-form">
    <input type="text" id="chatName" placeholder="Your name" required />
    <input type="text" id="chatMessage" placeholder="Type a message..." required />
    <input type="file" id="chatImage" accept="image/*" />
    <button type="submit" class="btn primary">Send</button>
  </form>
</section>


    <!-- Old volunteer parking section removed - now integrated into volunteer dashboard -->

    <section id="emergency" class="view hidden">
      <div class="crumbs">
        <button type="button" class="btn ghost back" data-view="dashboard">â† Back</button>
      </div>
      <h2 class="view-title">Medical</h2>
      
      <div id="user-medical" class="medical-container">
        <p>If you need immediate medical assistance, press the SOS button below:</p>
        <button id="sos-button" class="sos-button">HELP!</button>
        <div id="location-status" class="status-message hidden">Sending your location...</div>
        <div class="map-preview">
          <h4>Your Location in Navi Mumbai</h4>
          <div id="user-map" class="small-map"></div>
        </div>
      </div>
      
      <div id="volunteer-medical" class="medical-container hidden">
        <h3>Medical Emergency Map - Navi Mumbai</h3>
        <div id="emergency-map" class="map-container">
          </div>
        <div id="emergency-list" class="emergency-list">
          <h4>Active Emergency Requests</h4>
          <ul id="emergency-requests" class="list">
            </ul>
        </div>
        <div class="map-controls">
          <button id="refresh-map" class="btn primary">Refresh Map</button>
          <button id="center-map" class="btn ghost">Center on Navi Mumbai</button>
        </div>
      </div>
    </section>
  </main>

  <nav class="bottom-nav">
    <button data-view="dashboard" class="tab active">ğŸ </button>
    <button data-view="schedule" class="tab">ğŸ“…</button>
    <button data-view="announcements" class="tab">ğŸ“¢</button>
    <button data-view="emergency" class="tab">ğŸš¨</button>
  </nav>

  <div id="toast" class="toast hidden"></div>
  
  <script src="../assets/qrcode.min.js"></script>
  <script src="../js/maps.js"></script>
  <script src="../js/main.js"></script>
</body>
</html>